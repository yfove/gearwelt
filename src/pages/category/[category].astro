---
export async function getStaticPaths() {
const allPosts = await Astro.glob("../../pages/post/**/*.mdx");

// Extract unique, lowercase categories
const allCategories = new Set();
for (const post of allPosts) {
const tags = post.frontmatter.tags || [];
tags.forEach(tag => allCategories.add(tag.toLowerCase()));
}

// Generate one path per category
const paths = Array.from(allCategories).map(category => ({
params: { category },
props: { posts: allPosts }
}));

return paths;
}

const { category } = Astro.params;
const { posts } = Astro.props;

// Filter posts by category (lowercase match)
const filteredPosts = posts.filter((post) =>
(post.frontmatter.tags || []).some(tag => tag.toLowerCase() === category)
);
---

<html>

<head>
    <title>{category} â€“ GearWelt</title>
</head>

<body class="bg-white text-black">
    <main class="max-w-5xl mx-auto p-6">
        <h1 class="text-3xl font-bold capitalize mb-6">{category}</h1>

        <ul class="grid grid-cols-1 sm:grid-cols-2 gap-6">
            {filteredPosts.map(post => (
            <li>
                <a href={`/post/${post.frontmatter.slug}`} class="hover:underline">
                    <h2 class="text-xl font-semibold">{post.frontmatter.title}</h2>
                    <p class="text-sm text-gray-600">{post.frontmatter.description}</p>
                </a>
            </li>
            ))}
        </ul>
    </main>
</body>

</html>